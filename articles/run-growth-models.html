<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>run growth models • Growth</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="run growth models">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Growth</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/run-growth-models.html">run growth models</a></li>
    <li><a class="dropdown-item" href="../articles/useful-functions.html">Useful Functions</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>run growth models</h1>
            
      

      <div class="d-none name"><code>run-growth-models.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">Growth</span><span class="op">)</span></span></code></pre></div>
<!-- WARNING - This vignette is generated by {fusen} from dev/flat_main.Rmd: do not edit by hand -->
<!--
You need to run the 'description' chunk in the '0-dev_history.Rmd' file before continuing your code there.
-->
<div class="section level5">
<h5 id="install-nimble">Install <code>nimble</code><a class="anchor" aria-label="anchor" href="#install-nimble"></a>
</h5>
<p>If you never used the package <code>nimble</code>, you first need to
install it following recommendations <a href="https://r-nimble.org/download" class="external-link">here</a></p>
</div>
<div class="section level2">
<h2 id="run-a-single-model">Run a single model<a class="anchor" aria-label="anchor" href="#run-a-single-model"></a>
</h2>
<p>The function <code><a href="../reference/Gro_run.html">Gro_run()</a></code> allows to run one growth model.
This function takes as arguments:</p>
<ul>
<li>
<code>x</code> the index of the formula to use</li>
<li>
<code>dat</code> including at least the numeric columns
<em>Age</em>, <em>MeasurementValue</em> and <em>AnimalAnonID</em>
</li>
<li>
<code>all_mods</code> a vector of model names. The following models
are supported : logistic, gompertz, tpgm, power, richards,
vonbertalanffy.</li>
<li>
<code>random</code> list of the model names giving the parameters
that should be included an individual random effect</li>
<li>
<code>run</code>: a list of Bayesian parameters including
<code>nch</code> number of chains, <code>nthin</code> interval between
iterations to keep, <code>nburnin</code> number of iterations to discard
and <code>niter</code> total number of iterations. The default number of
iterations is too small and need to be increased to reach
convergence.</li>
</ul>
<p>Only the model of index <code>x</code> will be used to run the
model.</p>
<p>The function returns:</p>
<ul>
<li>
<code>model</code> a list including estimates of coefficients and
model characteristics</li>
<li>
<code>tab</code> a data frame with information on model wAIC</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">age</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">id1</span> <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">21</span>,<span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">id2</span> <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">21</span>,<span class="fl">0</span>, <span class="fl">0.4</span><span class="op">)</span></span>
<span><span class="va">id3</span> <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">21</span>,<span class="fl">0</span>, <span class="fl">0.3</span><span class="op">)</span></span>
<span><span class="va">IND</span> <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fl">0.2</span><span class="op">+</span> <span class="va">id1</span><span class="op">[</span><span class="va">IND</span><span class="op">]</span><span class="op">+</span> <span class="op">(</span><span class="fl">15</span> <span class="op">+</span> <span class="va">id2</span><span class="op">[</span><span class="va">IND</span><span class="op">]</span><span class="op">)</span><span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span> <span class="va">id3</span><span class="op">[</span><span class="va">IND</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>age <span class="op">=</span> <span class="va">age</span>, z <span class="op">=</span> <span class="va">z</span>, </span>
<span>                 IND <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">IND</span> ,labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">IND</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Run a vonbertalanffy model including an individual effect on z0</span></span>
<span><span class="va">out</span> <span class="op">=</span> <span class="fu"><a href="../reference/Gro_run.html">Gro_run</a></span><span class="op">(</span><span class="fl">1</span>, </span>
<span>              <span class="va">dat</span>,</span>
<span>              all_mods  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vonbertalanffy"</span><span class="op">)</span>,</span>
<span>              random <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"z0"</span><span class="op">)</span>,</span>
<span>              run <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nit <span class="op">=</span> <span class="fl">500</span>, nburnin <span class="op">=</span> <span class="fl">100</span>, nthin <span class="op">=</span> <span class="fl">10</span>, nch <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; nimble version 1.3.0 is loaded.</span></span>
<span><span class="co">#&gt; For more information on NIMBLE and a User Manual,</span></span>
<span><span class="co">#&gt; please visit https://R-nimble.org.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Note for advanced users who have written their own MCMC samplers:</span></span>
<span><span class="co">#&gt;   As of version 0.13.0, NIMBLE's protocol for handling posterior</span></span>
<span><span class="co">#&gt;   predictive nodes has changed in a way that could affect user-defined</span></span>
<span><span class="co">#&gt;   samplers in some situations. Please see Section 15.5.1 of the User Manual.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'nimble'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     simulate</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     declare</span></span>
<span><span class="co">#&gt; |-------------|-------------|-------------|-------------|</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------|</span></span>
<span><span class="co">#&gt; |-------------|-------------|-------------|-------------|</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------|</span></span>
<span><span class="co">#&gt; |-------------|-------------|-------------|-------------|</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------|</span></span>
<span><span class="co">#&gt;   [Warning] There are 1107 individual pWAIC values that are greater than 0.4. This may indicate that the WAIC estimate is unstable (Vehtari et al., 2017), at least in cases without grouping of data nodes or multivariate data nodes.</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">tab</span></span>
<span><span class="co">#&gt;       model_type random index Nparam     WAIC     lppd</span></span>
<span><span class="co">#&gt; 1 vonbertalanffy     z0     1      7 18392206 -36070.8</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="growth-analysis-run-multiple-models">Growth analysis: run multiple models<a class="anchor" aria-label="anchor" href="#growth-analysis-run-multiple-models"></a>
</h2>
<p>This function fits a series of growth models to a dataset, and select
the best one by wAIC. It takes as arguments:</p>
<ul>
<li>data_weight including at least the numeric columns <em>Age</em>,
<em>MeasurementValue</em> and <em>AnimalAnonID</em>
</li>
<li>all_mods indicating the growth models that need to be fit.The
following models are supported : logistic, gompertz, tpgm, power,
richards, vonbertalanffy. default = “vonBertalanffy”</li>
<li>
<code>random</code> list of the model names giving the parameters
that should include an individual random effect. See the example</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Age</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="fl">1000</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">MeasurementValue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">0.2</span><span class="op">+</span><span class="fl">15</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">Age</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">0</span>,<span class="fl">0.01</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span> </span>
<span><span class="va">AnimalAnonID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Age <span class="op">=</span> <span class="va">Age</span>, MeasurementValue <span class="op">=</span> <span class="va">MeasurementValue</span>, </span>
<span>                 AnimalAnonID <span class="op">=</span> <span class="va">AnimalAnonID</span>, MeasurementType <span class="op">=</span> <span class="st">"Live Weight"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Test 4 models: vonbertalanffy including an individual random effect on z0</span></span>
<span><span class="co">#               vonbertalanffy including individual random effects on z0 and zinf</span></span>
<span><span class="co">#               gompertz including an individual random effect on gamma </span></span>
<span><span class="co">#               gompertz including no individual random effect</span></span>
<span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="../reference/Gro_analysis.html">Gro_analysis</a></span><span class="op">(</span><span class="va">dat</span>, all_mods  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vonbertalanffy"</span>, <span class="st">"gompertz"</span><span class="op">)</span>,</span>
<span>                 random <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>vonbertalanffy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"z0"</span>, <span class="st">"z0, zinf"</span><span class="op">)</span>, gompertz <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gamma"</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 run <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nit <span class="op">=</span> <span class="fl">1000</span>, nburnin <span class="op">=</span> <span class="fl">100</span>, nthin <span class="op">=</span> <span class="fl">1</span>, nch <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  * parallel has been set to FALSE, please wait more !</span></span>
<span><span class="co">#&gt; |-------------|-------------|-------------|-------------|</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------|</span></span>
<span><span class="co">#&gt; |-------------|-------------|-------------|-------------|</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------|</span></span>
<span><span class="co">#&gt; |-------------|-------------|-------------|-------------|</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------|</span></span>
<span><span class="co">#&gt;   [Warning] There are 5 individual pWAIC values that are greater than 0.4. This may indicate that the WAIC estimate is unstable (Vehtari et al., 2017), at least in cases without grouping of data nodes or multivariate data nodes.</span></span>
<span><span class="co">#&gt; |-------------|-------------|-------------|-------------|</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------|</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="growth-model-setting">Growth Model Setting<a class="anchor" aria-label="anchor" href="#growth-model-setting"></a>
</h2>
<p>This function gets the parameter and equations for the growth model
and takes as arguments:</p>
<ul>
<li>
<code>data</code>, a data frame including at least the numeric
columns <em>age</em>, <em>z</em> and <em>IND</em>
</li>
<li>
<code>random</code> name of the parameters that must include an
individual random effect</li>
<li>
<code>mod</code> Name of the model to fit. The following models are
supported : logistic, gompertz, tpgm, power, richards,
vonbertalanffy.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">age</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fl">0.2</span><span class="op">+</span> <span class="fl">15</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>age <span class="op">=</span> <span class="va">age</span>, z <span class="op">=</span> <span class="va">z</span>,IND <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Gro_ModSettings.html">Gro_ModSettings</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dat</span>, mod <span class="op">=</span> <span class="st">"vonbertalanffy"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plot-model-prediction">Plot model prediction<a class="anchor" aria-label="anchor" href="#plot-model-prediction"></a>
</h2>
<p>This function gives the predicted values of the model and plots to
check the convergence of the model. It takes as arguments:</p>
<ul>
<li>
<code>data</code> including at least the numeric columns
<em>Age</em>, <em>MeasurementValue</em> and <em>AnimalAnonID</em>
</li>
<li>
<code>out</code> result output named <code>model</code> from
Gro_run() or from Gro$analysis()</li>
</ul>
<p>It returns the following object:</p>
<p><em><code>summary</code>shomwing mean, standard deviation, credible
interval at 95% and the Gelman-Rubin statistics Rhat of each parameter.
</em> <code>predictions</code> giving the mean estimates and credible
interval at 95% of each age <code>GOF</code>: 4 tests of goodness of
fit: “normal”: test if residuals are normally distributes ; “X”; test if
there is a trend between residual and Age, “var”: Test if there is the
trend in the variance of the residuals over Age ,“conv”: check if all
Rhat &lt; 1.1 * <code>plot_pred</code> Plot of the predicted values,
credible interval at 95% in grey and data points. *
<code>convergence</code>: Plots of the Bayesian chains *
<code>posterior</code>: Plots of the posterior distribution for each
parameter</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Age</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">AnimalAnonID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">MeasurementValue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">0.2</span><span class="op">+</span><span class="fl">15</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">Age</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span> </span>
<span>                          <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">0</span>,<span class="fl">0.01</span><span class="op">)</span> <span class="op">+</span> <span class="va">AnimalAnonID</span><span class="op">*</span><span class="fl">0.1</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span> </span>
<span><span class="va">dat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Age <span class="op">=</span> <span class="va">Age</span>, MeasurementValue <span class="op">=</span> <span class="va">MeasurementValue</span>, </span>
<span>                 AnimalAnonID <span class="op">=</span> <span class="va">AnimalAnonID</span>, MeasurementType <span class="op">=</span> <span class="st">"Live Weight"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">out</span> <span class="op">=</span> <span class="fu"><a href="../reference/Gro_analysis.html">Gro_analysis</a></span><span class="op">(</span><span class="va">dat</span>, </span>
<span>                   all_mods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vonbertalanffy"</span><span class="op">)</span>,</span>
<span>                   run <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nit <span class="op">=</span> <span class="fl">1000</span>, nburnin <span class="op">=</span> <span class="fl">100</span>, nthin <span class="op">=</span> <span class="fl">1</span>, nch <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  * parallel has been set to FALSE, please wait more !</span></span>
<span><span class="co">#&gt; |-------------|-------------|-------------|-------------|</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------|</span></span>
<span><span class="co">#&gt; |-------------|-------------|-------------|-------------|</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------|</span></span>
<span><span class="co">#&gt; |-------------|-------------|-------------|-------------|</span></span>
<span><span class="co">#&gt; |-------------------------------------------------------|</span></span>
<span><span class="co">#&gt;   [Warning] There are 100 individual pWAIC values that are greater than 0.4. This may indicate that the WAIC estimate is unstable (Vehtari et al., 2017), at least in cases without grouping of data nodes or multivariate data nodes.</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Gro_pred.html">Gro_pred</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dat</span>, </span>
<span>              out <span class="op">=</span> <span class="va">out</span><span class="op">$</span><span class="va">model</span>, </span>
<span>              title <span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">wAIC_tab</span><span class="op">$</span><span class="va">model</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; Registered S3 methods overwritten by 'ggpp':</span></span>
<span><span class="co">#&gt;   method                  from   </span></span>
<span><span class="co">#&gt;   heightDetails.titleGrob ggplot2</span></span>
<span><span class="co">#&gt;   widthDetails.titleGrob  ggplot2</span></span>
<span><span class="va">p</span><span class="op">$</span><span class="va">summary</span></span>
<span><span class="co">#&gt;                   mean           sd       QI 2.5      QI 97.5     Rhat</span></span>
<span><span class="co">#&gt; mu_gamma  1.553454e-01  0.219129831 5.698775e-02   0.90074862 4.802228</span></span>
<span><span class="co">#&gt; mu_z0     4.118427e+00  4.585071490 3.580791e-02  17.96910144 1.440578</span></span>
<span><span class="co">#&gt; mu_zinf   1.459979e+02 35.092272436 8.162425e+01 211.11933912 1.797136</span></span>
<span><span class="co">#&gt; sigma_res 3.543928e-03  0.009446629 3.001142e-06   0.02926164 1.349719</span></span>
<span><span class="va">p</span><span class="op">$</span><span class="va">predictions</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 102 × 4</span></span></span>
<span><span class="co">#&gt;      Age  mean Conf_Int_low Conf_Int_up</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>   0    4.12       0.035<span style="text-decoration: underline;">8</span>        18.0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>   0.1  6.10       1.35          23.9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>   0.2  8.00       2.62          32.9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>   0.3  9.83       3.85          41.5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>   0.4 11.6        5.07          50.0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>   0.5 13.3        6.29          57.9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>   0.6 14.9        7.49          63.9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>   0.7 16.5        8.68          70.3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>   0.8 18.0        9.84          76.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>   0.9 19.5       11.0           82.0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 92 more rows</span></span></span>
<span><span class="va">p</span><span class="op">$</span><span class="va">GOF</span></span>
<span><span class="co">#&gt; $normal</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $X</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $var</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $conv</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="va">p</span><span class="op">$</span><span class="va">plot_pred</span></span></code></pre></div>
<p><img src="run-growth-models_files/figure-html/example-Gro_pred-1.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span><span class="op">$</span><span class="va">convergence</span></span></code></pre></div>
<p><img src="run-growth-models_files/figure-html/example-Gro_pred-2.png" width="700"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span><span class="op">$</span><span class="va">posterior</span></span></code></pre></div>
<p><img src="run-growth-models_files/figure-html/example-Gro_pred-3.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Floriane Plard.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
