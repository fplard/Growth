<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Growth model selection — Gro_analysis • Growth</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Growth model selection — Gro_analysis"><meta name="description" content="This function fit a series of growth models to a dataset and select the best one by wAIC."><meta property="og:description" content="This function fit a series of growth models to a dataset and select the best one by wAIC."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Growth</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/run-growth-models.html">run growth models</a></li>
    <li><a class="dropdown-item" href="../articles/useful-functions.html">Useful Functions</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Growth model selection</h1>

      <div class="d-none name"><code>Gro_analysis.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function fit a series of growth models to a dataset and select the best one by wAIC.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Gro_analysis</span><span class="op">(</span></span>
<span>  <span class="va">data_weight</span>,</span>
<span>  all_mods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vonbertalanffy"</span><span class="op">)</span>,</span>
<span>  random <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  logtransform <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  run <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nit <span class="op">=</span> <span class="fl">100</span>, nburnin <span class="op">=</span> <span class="fl">10</span>, nthin <span class="op">=</span> <span class="fl">1</span>, nch <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data-weight">data_weight<a class="anchor" aria-label="anchor" href="#arg-data-weight"></a></dt>
<dd><p><code>data.frame</code> including at least the numeric columns <em>Age</em>, <em>MeasurementValue</em> and <em>AnimalAnonID</em></p></dd>


<dt id="arg-all-mods">all_mods<a class="anchor" aria-label="anchor" href="#arg-all-mods"></a></dt>
<dd><p><code>vector of character</code> indicating the growth models that need to be fit.The following models are supported :logistic, gompertz, tpgm, power, richards, vonbertalanffy. default = "vonBertalanffy"</p></dd>


<dt id="arg-random">random<a class="anchor" aria-label="anchor" href="#arg-random"></a></dt>
<dd><p>list of the model names giving the parameters that should include an individual random effect. See the example</p></dd>


<dt id="arg-logtransform">logtransform<a class="anchor" aria-label="anchor" href="#arg-logtransform"></a></dt>
<dd><p>logical whether age and measurement values should be log transform (+1 is added to avoid having log(0))</p></dd>


<dt id="arg-run">run<a class="anchor" aria-label="anchor" href="#arg-run"></a></dt>
<dd><p><code>list</code> Bayesian parameters. They should be increased to reach convergence</p><ul><li><p><code>nch</code> number of chains.</p></li>
<li><p><code>nthin</code> interval between iterations to keep.</p></li>
<li><p><code>nburnin</code> number of iterations to discard.</p></li>
<li><p><code>nit</code> total number of iterations.</p></li>
</ul></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p><code>logical</code> Whether the model should be run in parallel</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a list including:</p><ul><li><p>model: the fit of the best model</p></li>
<li><p>the wAIC table of the model</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">Age</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="fl">1000</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">MeasurementValue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">0.2</span><span class="op">+</span><span class="fl">15</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">Age</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">0</span>,<span class="fl">0.01</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span> </span></span>
<span class="r-in"><span><span class="va">AnimalAnonID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Age <span class="op">=</span> <span class="va">Age</span>, MeasurementValue <span class="op">=</span> <span class="va">MeasurementValue</span>, </span></span>
<span class="r-in"><span>                 AnimalAnonID <span class="op">=</span> <span class="va">AnimalAnonID</span>, MeasurementType <span class="op">=</span> <span class="st">"Live Weight"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Test 4 models: vonbertalanffy including an individual random effect on z0</span></span></span>
<span class="r-in"><span><span class="co">#               vonbertalanffy including individual random effects on z0 and zinf</span></span></span>
<span class="r-in"><span><span class="co">#               gompertz including an individual random effect on gamma </span></span></span>
<span class="r-in"><span><span class="co">#               gompertz including no individual random effect</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">=</span> <span class="fu">Gro_analysis</span><span class="op">(</span><span class="va">dat</span>, all_mods  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vonbertalanffy"</span>, <span class="st">"gompertz"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 random <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>vonbertalanffy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"z0"</span>, <span class="st">"z0, zinf"</span><span class="op">)</span>, gompertz <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gamma"</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 run <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nit <span class="op">=</span> <span class="fl">1000</span>, nburnin <span class="op">=</span> <span class="fl">100</span>, nthin <span class="op">=</span> <span class="fl">1</span>, nch <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	* parallel has been set to FALSE, please wait more !</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> nimble version 1.3.0 is loaded.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> For more information on NIMBLE and a User Manual,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> please visit https://R-nimble.org.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note for advanced users who have written their own MCMC samplers:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   As of version 0.13.0, NIMBLE's protocol for handling posterior</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   predictive nodes has changed in a way that could affect user-defined</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   samplers in some situations. Please see Section 15.5.1 of the User Manual.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘nimble’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from ‘package:stats’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     simulate</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from ‘package:base’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     declare</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |-------------|-------------|-------------|-------------|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |-------------------------------------------------------|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |-------------|-------------|-------------|-------------|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |-------------------------------------------------------|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [Warning] There are 1 individual pWAIC values that are greater than 0.4. This may indicate that the WAIC estimate is unstable (Vehtari et al., 2017), at least in cases without grouping of data nodes or multivariate data nodes.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |-------------|-------------|-------------|-------------|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |-------------------------------------------------------|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [Warning] There are 22 individual pWAIC values that are greater than 0.4. This may indicate that the WAIC estimate is unstable (Vehtari et al., 2017), at least in cases without grouping of data nodes or multivariate data nodes.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |-------------|-------------|-------------|-------------|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |-------------------------------------------------------|</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Floriane Plard.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

